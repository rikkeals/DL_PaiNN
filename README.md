# Molecular Property Prediction with PaiNN

This repository contains code for training and evaluating the **PaiNN (Polarizable Atom Interaction Neural Network)** on the QM9 molecular dataset.

## Overview

The files in this repository are all interconnected, except for `PaiNN.ipynb`, which is a self-contained notebook that can be run independently.

The main script is `run_model.py`, which handles model training and evaluation. It interacts with other components in the repository and outputs results to a `runs/` directory.

## Running the Code

To run the model, use the provided shell script:

```bash
bash run_model.sh
```

This script performs a **grid search** over several hyperparameters:

- Number of message passing layers
- Number of features
- Number of radial basis functions
- Cut-off distance
- Target property index (QM9 includes multiple regression targets)

The `run_model.py` script generates outputs in the `runs/` directory, which can be visualized using `plots.ipynb`.

**Important:** Do not change the folder structure. For example, the model code is expected to be in `src/models/`.

## Folder Structure

- `src/data/`: Module for loading and initializing the QM9 dataset.
- `src/models/`: Implementation of the PaiNN model and atomwise postprocessing.
- `runs/`: Will be automatically created with model outputs and logs.

## Environment Setup

To ensure all dependencies are installed, create and activate a conda environment:

```bash
conda env create -f environment.yml
conda activate painn
```

## Contents

- `Message_Update.py`: Message and update functions
- `run_model.py`: Main training and evaluation script.
- `run_model.sh`: Shell script for running a grid search over hyperparameters.
- `plots.ipynb`: Visualizes results generated by `run_model.py`.
- `helper_functions.py`: Utility functions.
- `environment.yml`: Defines the conda environment.
- `PaiNN.ipynb`: Standalone notebook containing an all-in-one PaiNN example.
- `README.md`: This file.
